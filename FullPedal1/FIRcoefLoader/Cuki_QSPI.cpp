//#include "daisy_pod.h"
#include "daisy_seed.h"
#include "daisysp.h"

using namespace daisy;
using namespace daisysp;

//DaisyPod hw;
DaisySeed hw;
Switch FSW1; // Footswitches are D25-26
Switch FSW2; // Footswitches are D25-26
GPIO led1;
GPIO led2;



//Setting Struct containing parameters we want to save to flash
struct Settings {
	float p1[2048]; // IR1
	float p2[1024]; // IR2
    /* Generated with AutoIR_load_txt2.m matlab code */

	//Overloading the != operator
	//This is necessary as this operator is used in the PersistentStorage source code
	bool operator!=(const Settings& a) const {
        return !(a.p1==p1 && a.p2==p2);
    }
};

//Persistent Storage Declaration. Using type Settings and passed the devices qspi handle
//PersistentStorage<Settings> SavedSettings(hw.seed.qspi);
PersistentStorage<Settings> SavedSettings(hw.qspi);

//Reverb and Parameters

float state2[1024]={0};
float state1[2048]={0};
bool use_preset = false;
bool trigger_save = false;


void Load() {

	//Reference to local copy of settings stored in flash
	Settings &LocalSettings = SavedSettings.GetSettings();
	memcpy(&state1, &LocalSettings.p1, 2048 * sizeof(float));
    memcpy(&state2, &LocalSettings.p2, 1024 * sizeof(float)); //ok
    // for(size_t i = 0; i < 2048; i += 1)
    // {
    //     state1[i]=LocalSettings.p1[i];
    // }
	//state1 = LocalSettings.p1;

	use_preset = true;
}

void Save() {
    float P1[2048]={0.00141,0.00141 ,0.00141 ,0.00140 ,0.00140 ,0.00140 ,0.00140 ,0.00140 ,0.00141 ,0.00142 ,0.00143 ,0.00145 ,0.00147 ,0.00149 ,0.00151 ,0.00153 ,0.00154 ,0.00156 ,0.00158 ,0.00161 ,0.00164 ,0.00166 ,0.00168 ,0.00169 ,0.00169 ,0.00169 ,0.00167 ,0.00164 ,0.00163 ,0.00162 ,0.00164 ,0.00164 ,0.00163 ,0.00160 ,0.00157 ,0.00155 ,0.00155 ,0.00153 ,0.00153 ,0.00154 ,0.00157 ,0.00161 ,0.00164 ,0.00165 ,0.00165 ,0.00164 ,0.00163 ,0.00170 ,0.00174 ,0.00176 ,0.00174 ,0.00171 ,0.00171 ,0.00171 ,0.00178 ,0.00177 ,0.00174 ,0.00170 ,0.00166 ,0.00169 ,0.00166 ,0.00166 ,0.00163 ,0.00161 ,0.00163 ,0.00156 ,0.00158 ,0.00148 ,0.00143 ,0.00143 ,0.00143 ,0.00153 ,0.00149 ,0.00154 ,0.00157 ,0.00156 ,0.00154 ,0.00154 ,0.00157 ,0.00151 ,0.00151 ,0.00152 ,0.00147 ,0.00155 ,0.00148 ,0.00152 ,0.00158 ,0.00158 ,0.00154 ,0.00151 ,0.00142 ,0.00136 ,0.00116 ,0.00126 ,0.00129 ,0.00138 ,0.00126 ,0.00120 ,0.00106 ,0.00111 ,0.00115 ,0.00105 ,0.00103 ,0.00102 ,0.00114 ,0.00129 ,0.00128 ,0.00127 ,0.00114 ,0.00113 ,0.00105 ,0.00105 ,0.00105 ,0.00107 ,0.00111 ,0.00137 ,0.00132 ,0.00141 ,0.00108 ,0.00085 ,0.00081 ,0.00098 ,0.00101 ,0.00084 ,0.00077 ,0.00090 ,0.00101 ,0.00087 ,0.00064 ,0.00059 ,0.00066 ,0.00036 ,0.00019 ,0.00030 ,0.00046 ,0.00057 ,0.00052 ,0.00039 ,0.00028 ,0.00047 ,0.00051 ,0.00052 ,0.00053 ,0.00055 ,0.00047 ,0.00045 ,0.00063 ,0.00064 ,0.00041 ,0.00017 ,0.00025 ,0.00037 ,0.00005 ,0.00003 ,0.00008 ,0.00006 ,0.00018 ,0.00015 ,0.00030 ,0.00007 ,-0.00004 ,-0.00042 ,-0.00028 ,-0.00007 ,0.00017 ,-0.00000 ,0.00038 ,0.00015 ,-0.00005 ,-0.00056 ,-0.00061 ,-0.00077 ,-0.00046 ,-0.00018 ,-0.00032 ,-0.00011 ,-0.00030 ,-0.00031 ,-0.00023 ,-0.00059 ,-0.00085 ,-0.00116 ,-0.00106 ,-0.00042 ,-0.00039 ,-0.00083 ,-0.00094 ,-0.00071 ,-0.00096 ,-0.00052 ,-0.00062 ,-0.00075 ,-0.00102 ,-0.00138 ,-0.00193 ,-0.00170 ,-0.00132 ,-0.00068 ,-0.00113 ,-0.00089 ,-0.00080 ,-0.00099 ,-0.00082 ,-0.00113 ,-0.00078 ,-0.00131 ,-0.00113 ,-0.00136 ,-0.00180 ,-0.00174 ,-0.00205 ,-0.00175 ,-0.00150 ,-0.00104 ,-0.00123 ,-0.00099 ,-0.00082 ,-0.00140 ,-0.00225 ,-0.00277 ,-0.00195 ,-0.00150 ,-0.00082 ,-0.00096 ,-0.00134 ,-0.00106 ,-0.00212 ,-0.00314 ,-0.00290 ,-0.00198 ,-0.00170 ,-0.00205 ,-0.00193 ,-0.00174 ,-0.00151 ,-0.00169 ,-0.00209 ,-0.00200 ,-0.00273 ,-0.00260 ,-0.00244 ,-0.00250 ,-0.00197 ,-0.00187 ,-0.00204 ,-0.00241 ,-0.00270 ,-0.00227 ,-0.00197 ,-0.00232 ,-0.00252 ,-0.00273 ,-0.00234 ,-0.00159 ,-0.00114 ,-0.00141 ,-0.00257 ,-0.00324 ,-0.00285 ,-0.00287 ,-0.00234 ,-0.00264 ,-0.00125 ,-0.00162 ,-0.00152 ,-0.00239 ,-0.00297 ,-0.00306 ,-0.00295 ,-0.00293 ,-0.00296 ,-0.00278 ,-0.00256 ,-0.00165 ,-0.00165 ,-0.00280 ,-0.00405 ,-0.00372 ,-0.00385 ,-0.00440 ,-0.00417 ,-0.00277 ,-0.00163 ,-0.00205 ,-0.00244 ,-0.00396 ,-0.00349 ,-0.00238 ,-0.00134 ,-0.00174 ,-0.00114 ,-0.00206 ,-0.00229 ,-0.00339 ,-0.00271 ,-0.00283 ,-0.00223 ,-0.00283 ,-0.00296 ,-0.00286 ,-0.00204 ,-0.00259 ,-0.00321 ,-0.00348 ,-0.00293 ,-0.00248 ,-0.00338 ,-0.00333 ,-0.00293 ,-0.00228 ,-0.00162 ,-0.00207 ,-0.00141 ,-0.00250 ,-0.00304 ,-0.00302 ,-0.00424 ,-0.00431 ,-0.00378 ,-0.00446 ,-0.00324 ,-0.00228 ,-0.00175 ,-0.00156 ,-0.00247 ,-0.00252 ,-0.00260 ,-0.00224 ,-0.00298 ,-0.00318 ,-0.00226 ,-0.00195 ,-0.00270 ,-0.00271 ,-0.00270 ,-0.00155 ,-0.00209 ,-0.00203 ,-0.00185 ,-0.00298 ,-0.00329 ,-0.00308 ,-0.00405 ,-0.00210 ,-0.00112 ,-0.00176 ,-0.00145 ,-0.00308 ,-0.00188 ,-0.00326 ,-0.00325 ,-0.00362 ,-0.00308 ,-0.00199 ,-0.00207 ,-0.00123 ,-0.00260 ,-0.00215 ,-0.00121 ,-0.00060 ,-0.00121 ,-0.00211 ,-0.00256 ,-0.00035 ,-0.00271 ,-0.00286 ,-0.00244 ,-0.00107 ,-0.00035 ,-0.00039 ,-0.00043 ,-0.00067 ,-0.00167 ,-0.00285 ,-0.00332 ,-0.00143 ,0.00024 ,-0.00013 ,-0.00225 ,-0.00150 ,-0.00009 ,-0.00002 ,-0.00073 ,-0.00178 ,-0.00177 ,-0.00175 ,-0.00033 ,0.00037 ,-0.00122 ,-0.00238 ,-0.00258 ,-0.00116 ,-0.00056 ,-0.00014 ,-0.00147 ,-0.00059 ,-0.00068 ,-0.00036 ,-0.00161 ,-0.00149 ,-0.00035 ,0.00081 ,0.00006 ,0.00123 ,0.00109 ,0.00099 ,0.00076 ,-0.00149 ,-0.00201 ,-0.00131 ,0.00137 ,0.00200 ,0.00088 ,-0.00085 ,-0.00125 ,-0.00167 ,-0.00233 ,-0.00121 ,0.00180 ,0.00132 ,-0.00024 ,0.00001 ,0.00024 ,0.00011 ,-0.00001 ,0.00157 ,0.00102 ,0.00055 ,-0.00005 ,0.00037 ,0.00120 ,-0.00086 ,0.00133 ,0.00418 ,0.00609 ,0.00286 ,0.00173 ,0.00123 ,0.00090 ,-0.00093 ,-0.00069 ,0.00281 ,0.00547 ,0.00420 ,0.00237 ,0.00216 ,0.00088 ,-0.00036 ,-0.00154 ,0.00196 ,0.00152 ,-0.00001 ,-0.00032 ,0.00097 ,0.00366 ,0.00251 ,0.00249 ,0.00205 ,0.00275 ,0.00281 ,0.00086 ,0.00125 ,0.00012 ,0.00108 ,0.00163 ,0.00045 ,0.00141 ,0.00463 ,0.00510 ,0.00161 ,-0.00034 ,0.00048 ,0.00054 ,0.00094 ,0.00081 ,0.00294 ,0.00234 ,0.00449 ,0.00536 ,0.00568 ,0.00281 ,-0.00032 ,0.00145 ,0.00148 ,0.00407 ,0.00169 ,0.00179 ,0.00247 ,0.00352 ,0.00693 ,0.00599 ,0.00498 ,0.00289 ,0.00198 ,0.00231 ,0.00253 ,0.00498 ,0.00214 ,0.00546 ,0.00677 ,0.00628 ,0.00681 ,0.00127 ,0.00179 ,0.00304 ,0.00602 ,0.00229 ,-0.00159 ,0.00055 ,0.00251 ,0.00225 ,0.00358 ,0.00409 ,0.00326 ,0.00031 ,0.00086 ,0.00288 ,0.00665 ,0.00349 ,0.00089 ,0.00514 ,0.00624 ,0.00561 ,0.00536 ,0.00373 ,0.00279 ,0.00132 ,0.00454 ,0.00840 ,0.00709 ,0.00462 ,0.00356 ,0.00633 ,0.00594 ,0.00419 ,0.00101 ,0.00162 ,0.00155 ,0.00429 ,0.00228 ,0.00548 ,0.00641 ,0.00389 ,0.00222 ,0.00344 ,0.00384 ,0.00356 ,0.00336 ,0.00501 ,0.00585 ,0.00328 ,0.00417 ,0.00104 ,-0.00006 ,0.00183 ,0.00601 ,0.00780 ,0.00516 ,0.00344 ,0.00064 ,0.00284 ,0.00213 ,0.00393 ,0.00755 ,0.00531 ,0.00691 ,0.00257 ,0.00212 ,0.00091 ,0.00016 ,0.00068 ,0.00122 ,0.00180 ,0.00387 ,0.00583 ,0.00568 ,0.00396 ,0.00175 ,-0.00039 ,0.00268 ,0.00332 ,-0.00009 ,0.00164 ,-0.00002 ,0.00514 ,0.00410 ,0.00235 ,0.00201 ,0.00275 ,0.00183 ,0.00116 ,0.00111 ,0.00209 ,0.00446 ,0.00379 ,0.00661 ,0.00608 ,0.00317 ,0.00259 ,0.00036 ,0.00085 ,0.00266 ,0.00224 ,-0.00073 ,0.00287 ,0.00106 ,0.00093 ,0.00069 ,-0.00201 ,0.00181 ,0.00344 ,0.00559 ,0.00425 ,0.00188 ,0.00148 ,0.00210 ,0.00190 ,-0.00012 ,0.00053 ,-0.00074 ,0.00402 ,0.00281 ,0.00238 ,-0.00066 ,-0.00408 ,-0.00289 ,0.00073 ,0.00786 ,0.00623 ,0.00159 ,-0.00008 ,-0.00457 ,-0.00150 ,-0.00343 ,-0.00222 ,0.00020 ,0.00335 ,0.00521 ,0.00616 ,0.00245 ,-0.00030 ,-0.00032 ,-0.00545 ,-0.00230 ,-0.00200 ,-0.00043 ,0.00177 ,0.00043 ,0.00091 ,0.00256 ,-0.00002 ,-0.00054 ,-0.00381 ,-0.00539 ,-0.00133 ,0.00123 ,-0.00175 ,-0.00400 ,0.00243 ,0.00145 ,-0.00011 ,-0.00345 ,-0.00426 ,-0.00077 ,-0.00380 ,-0.00447 ,-0.00073 ,0.00009 ,0.00194 ,0.00108 ,0.00311 ,0.00292 ,-0.00364 ,-0.00382 ,-0.00479 ,-0.00295 ,-0.00080 ,-0.00079 ,-0.00370 ,-0.00089 ,-0.00103 ,-0.00098 ,0.00139 ,-0.00249 ,-0.00467 ,-0.00617 ,-0.00516 ,-0.00561 ,-0.00552 ,-0.00413 ,-0.00464 ,-0.00163 ,-0.00112 ,-0.00150 ,-0.00202 ,-0.00107 ,-0.00375 ,-0.01201 ,-0.01170 ,-0.00736 ,-0.00362 ,0.00433 ,0.00491 ,0.00291 ,-0.00323 ,-0.00836 ,-0.00700 ,-0.00825 ,-0.01022 ,-0.00732 ,-0.00484 ,-0.00395 ,-0.00367 ,-0.00468 ,0.00144 ,-0.00334 ,0.00223 ,-0.00207 ,-0.00284 ,0.00144 ,-0.00232 ,-0.00617 ,-0.00571 ,-0.00592 ,-0.00615 ,-0.00121 ,-0.00479 ,-0.00053 ,-0.00312 ,-0.00285 ,-0.00769 ,-0.01139 ,-0.01104 ,-0.01212 ,-0.00820 ,-0.00405 ,0.00077 ,0.00180 ,0.00404 ,-0.00432 ,-0.01901 ,-0.01236 ,-0.00736 ,-0.00010 ,0.00244 ,0.00371 ,-0.00066 ,-0.00957 ,-0.01411 ,-0.01066 ,-0.00581 ,-0.00466 ,-0.00938 ,-0.01163 ,-0.00660 ,0.00199 ,0.00041 ,0.00091 ,0.00094 ,-0.00574 ,-0.00716 ,-0.01253 ,-0.00998 ,-0.00927 ,-0.00562 ,-0.00273 ,0.00115 ,0.00396 ,-0.00098 ,-0.00296 ,-0.00469 ,-0.01090 ,-0.00630 ,-0.01138 ,-0.01051 ,-0.01206 ,-0.00899 ,-0.00085 ,-0.00032 ,0.00573 ,-0.00092 ,-0.00715 ,-0.01237 ,-0.00825 ,-0.00009 ,0.00087 ,-0.00241 ,0.00052 ,0.00151 ,-0.00331 ,-0.00812 ,-0.00611 ,-0.00765 ,-0.00091 ,-0.00521 ,-0.00416 ,-0.00645 ,0.00204 ,-0.00271 ,-0.00705 ,-0.00565 ,-0.01069 ,-0.01128 ,-0.00672 ,-0.00470 ,-0.00803 ,-0.00393 ,0.00292 ,-0.00124 ,-0.00956 ,-0.01138 ,-0.00011 ,0.00238 ,0.00448 ,-0.00525 ,-0.00873 ,0.00127 ,0.00849 ,0.00500 ,-0.00129 ,-0.00663 ,-0.01402 ,-0.01413 ,-0.00702 ,-0.00359 ,0.00367 ,0.00514 ,0.00450 ,0.00066 ,-0.01189 ,-0.01348 ,-0.01385 ,-0.01930 ,-0.00225 ,0.00121 ,0.01752 ,-0.00336 ,-0.00555 ,-0.00754 ,-0.00907 ,-0.00668 ,-0.00743 ,-0.00648 ,0.00502 ,0.00654 ,-0.00173 ,-0.00287 ,-0.00991 ,-0.00814 ,-0.00529 ,0.00485 ,-0.00233 ,-0.00320 ,-0.00596 ,-0.00127 ,0.00564 ,0.01022 ,0.00361 ,-0.00111 ,-0.00209 ,-0.00456 ,-0.00227 ,-0.00419 ,-0.00138 ,0.00151 ,-0.00162 ,0.00035 ,0.00381 ,0.00070 ,-0.00403 ,-0.01135 ,-0.01201 ,0.00059 ,0.01090 ,0.01108 ,0.00995 ,0.00109 ,-0.00160 ,-0.00249 ,0.00629 ,0.00006 ,-0.00524 ,-0.00317 ,0.00050 ,0.00869 ,0.00741 ,0.00258 ,0.00260 ,-0.00188 ,-0.00623 ,-0.00909 ,-0.00567 ,-0.00292 ,0.00406 ,0.00611 ,0.00152 ,0.00375 ,0.00700 ,0.01078 ,-0.00700 ,0.00066 ,0.00347 ,0.00550 ,-0.00121 ,-0.00261 ,-0.00044 ,0.00467 ,0.00213 ,0.00789 ,0.00393 ,0.00300 ,-0.00127 ,0.00493 ,0.00978 ,0.01326 ,0.00689 ,-0.00673 ,0.00154 ,-0.00394 ,-0.00106 ,0.00574 ,0.00162 ,0.00348 ,0.00329 ,0.00542 ,0.00135 ,0.00150 ,-0.00219 ,0.00218 ,0.00502 ,0.01378 ,0.01417 ,0.00888 ,0.00984 ,0.01172 ,0.00604 ,0.00129 ,-0.00170 ,0.00703 ,0.00733 ,0.01775 ,0.01065 ,0.00886 ,-0.00685 ,-0.00937 ,-0.01033 ,0.00092 ,0.01530 ,0.01219 ,0.00127 ,0.00744 ,0.00529 ,0.01088 ,0.01325 ,-0.00351 ,-0.00032 ,0.00391 ,0.00821 ,0.00903 ,0.00766 ,0.00332 ,-0.00530 ,-0.00424 ,0.00499 ,0.00340 ,0.00691 ,0.00125 ,0.01757 ,0.01741 ,0.01845 ,-0.00047 ,-0.01017 ,0.00110 ,0.00974 ,0.01203 ,0.00540 ,0.00883 ,0.01295 ,-0.00049 ,0.00232 ,0.01159 ,0.01831 ,0.01520 ,0.00167 ,0.00356 ,0.01548 ,0.00543 ,0.00199 ,0.00974 ,0.00707 ,0.00216 ,0.00449 ,0.01054 ,0.01431 ,0.01766 ,0.00974 ,0.01660 ,0.02051 ,0.00932 ,0.00271 ,0.00167 ,0.01253 ,0.01407 ,0.01477 ,0.01263 ,0.00703 ,0.00238 ,0.00988 ,0.00584 ,0.00059 ,-0.00929 ,0.00130 ,0.00464 ,0.00801 ,0.00277 ,0.01295 ,0.01566 ,0.01959 ,0.00739 ,-0.00208 ,0.00046 ,-0.00010 ,0.00765 ,0.00877 ,0.00726 ,0.01187 ,0.00464 ,-0.00322 ,0.00202 ,0.00005 ,0.00852 ,0.01163 ,0.00889 ,0.00547 ,0.00544 ,0.02028 ,0.01363 ,0.01588 ,0.00950 ,0.01343 ,0.00671 ,0.00481 ,0.01674 ,0.01925 ,0.01221 ,-0.00072 ,0.00473 ,0.01329 ,0.02180 ,0.01079 ,0.00454 ,0.01181 ,0.00604 ,0.01618 ,0.00498 ,0.00480 ,-0.00237 ,0.00444 ,0.00347 ,0.00517 ,0.00992 ,0.00344 ,-0.00039 ,-0.00306 ,-0.01050 ,-0.00444 ,-0.00457 ,0.00226 ,0.01748 ,0.02593 ,0.03097 ,0.02104 ,0.01987 ,0.00332 ,-0.00541 ,-0.00845 ,-0.00073 ,0.00314 ,0.00636 ,0.01350 ,0.01439 ,0.01034 ,-0.00023 ,-0.00020 ,-0.01113 ,-0.00687 ,-0.01154 ,-0.00024 ,-0.00024 ,0.00114 ,0.01710 ,0.01376 ,0.01429 ,-0.00145 ,-0.01606 ,-0.01898 ,-0.00795 ,-0.00674 ,0.00149 ,0.01067 ,0.01604 ,0.01913 ,0.00014 ,-0.01086 ,-0.00707 ,0.00404 ,0.00575 ,0.01067 ,0.00737 ,0.00373 ,0.00402 ,-0.00880 ,-0.00705 ,-0.01005 ,0.01135 ,0.00093 ,0.00042 ,-0.00412 ,0.00689 ,0.00351 ,-0.01612 ,-0.02576 ,-0.02411 ,-0.00988 ,0.00676 ,-0.00417 ,0.00104 ,-0.00360 ,-0.00404 ,-0.00024 ,0.00790 ,0.00591 ,-0.00130 ,-0.01599 ,-0.01813 ,-0.01135 ,-0.00409 ,-0.00281 ,-0.00122 ,-0.00215 ,-0.01165 ,-0.00778 ,-0.00630 ,-0.00680 ,-0.00633 ,-0.01424 ,-0.00990 ,-0.00090 ,0.00636 ,0.02158 ,0.01057 ,-0.00905 ,-0.02076 ,-0.02295 ,-0.01849 ,-0.02258 ,-0.00278 ,0.02087 ,0.03014 ,0.00292 ,-0.01458 ,-0.02541 ,-0.02972 ,-0.02013 ,-0.00476 ,0.00148 ,0.01487 ,0.00483 ,0.00915 ,0.00624 ,-0.01133 ,-0.02604 ,-0.03290 ,-0.02397 ,-0.01693 ,0.00206 ,-0.00492 ,0.00835 ,-0.00427 ,-0.00240 ,0.00561 ,0.00928 ,-0.02039 ,-0.03467 ,-0.01629 ,0.00501 ,-0.00166 ,-0.00382 ,-0.00106 ,-0.01887 ,-0.02296 ,-0.01718 ,-0.00315 ,-0.01004 ,-0.01889 ,-0.02410 ,-0.01979 ,-0.01045 ,-0.02123 ,0.00015 ,-0.00020 ,0.00352 ,-0.01197 ,-0.02426 ,-0.03382 ,-0.03132 ,-0.02697 ,-0.02318 ,-0.01352 ,0.02116 ,0.03039 ,0.00115 ,-0.02172 ,-0.03207 ,-0.01162 ,-0.01783 ,-0.00959 ,0.01955 ,0.01677 ,0.00598 ,-0.00818 ,-0.00794 ,-0.02823 ,-0.05016 ,-0.05456 ,-0.02294 ,-0.01301 ,-0.00862 ,-0.00548 ,-0.00179 ,-0.00323 ,-0.00673 ,-0.00021 ,-0.00455 ,-0.00775 ,-0.02385 ,-0.02254 ,-0.00664 ,0.00690 ,0.00705 ,0.00169 ,-0.00341 ,-0.00529 ,-0.02351 ,-0.03460 ,-0.02891 ,0.00427 ,0.02500 ,0.03273 ,0.01047 ,0.00348 ,-0.00856 ,-0.01795 ,-0.03716 ,-0.05737 ,-0.04493 ,-0.02463 ,0.00918 ,0.02727 ,0.03246 ,0.02347 ,-0.00781 ,-0.03597 ,-0.04027 ,-0.02412 ,-0.01519 ,-0.00769 ,0.00575 ,0.00601 ,0.02241 ,0.00571 ,0.01067 ,-0.00444 ,-0.01111 ,-0.02720 ,-0.02453 ,-0.00160 ,-0.00061 ,0.00174 ,-0.00380 ,0.01594 ,0.01338 ,0.00161 ,-0.01817 ,-0.01171 ,0.01272 ,0.01170 ,0.01122 ,0.01392 ,-0.00581 ,-0.01226 ,-0.01597 ,-0.01419 ,-0.00123 ,-0.02041 ,-0.00621 ,-0.00211 ,0.01414 ,0.00691 ,-0.00255 ,0.00685 ,0.01784 ,-0.00130 ,0.00425 ,-0.01256 ,-0.00477 ,0.00685 ,0.02072 ,0.02975 ,0.01991 ,0.01936 ,-0.01140 ,-0.01572 ,-0.01765 ,0.00585 ,0.01234 ,0.01003 ,0.02526 ,0.01559 ,0.00065 ,-0.00429 ,-0.00654 ,-0.00294 ,-0.02112 ,-0.01369 ,-0.02185 ,0.00183 ,0.01206 ,0.02141 ,0.00210 ,0.00566 ,0.01904 ,-0.00222 ,-0.03223 ,-0.02318 ,-0.00139 ,0.01859 ,0.01665 ,0.00336 ,0.01102 ,0.00953 ,0.01786 ,0.01961 ,0.00094 ,-0.02259 ,-0.00477 ,0.00812 ,0.02915 ,0.01249 ,0.01004 ,-0.00389 ,-0.01128 ,0.00616 ,0.00298 ,0.01104 ,0.02203 ,0.02892 ,0.01622 ,0.02520 ,0.05032 ,0.03733 ,0.00270 ,-0.04463 ,-0.03029 ,-0.00385 ,0.01572 ,0.00211 ,0.01496 ,0.02223 ,0.00064 ,-0.02561 ,-0.01434 ,0.01965 ,0.02606 ,0.01135 ,0.00964 ,0.00851 ,0.01134 ,0.00394 ,0.00063 ,0.00746 ,0.00773 ,0.00485 ,0.00085 ,0.01164 ,0.00827 ,0.01260 ,0.00529 ,0.00719 ,0.00247 ,-0.00664 ,0.02508 ,0.02673 ,0.04271 ,0.02187 ,0.00722 ,0.00738 ,0.02379 ,0.01570 ,-0.00795 ,-0.02034 ,-0.00237 ,0.01980 ,0.03525 ,0.03013 ,0.00969 ,-0.01374 ,-0.02789 ,-0.02844 ,-0.01685 ,-0.00015 ,0.00940 ,0.01975 ,0.03082 ,0.04075 ,0.03746 ,0.00825 ,-0.00594 ,-0.00783 ,-0.00914 ,-0.00524 ,0.00618 ,0.01602 ,0.00976 ,0.00960 ,0.00400 ,0.01308 ,-0.00600 ,-0.02276 ,-0.00962 ,0.01146 ,0.01598 ,0.01419 ,0.02250 ,0.02916 ,0.02830 ,0.02236 ,0.00929 ,0.00740 ,-0.02180 ,-0.03059 ,-0.02632 ,-0.00242 ,0.03242 ,0.04453 ,0.03207 ,0.02161 ,0.00284 ,-0.01487 ,-0.01878 ,0.01357 ,0.00248 ,-0.01977 ,-0.03685 ,-0.01163 ,0.01252 ,0.01140 ,-0.01610 ,-0.02715 ,-0.02064 ,-0.00492 ,-0.01229 ,0.00353 ,0.02889 ,0.05001 ,0.03178 ,-0.00563 ,-0.02608 ,-0.00927 ,-0.00109 ,0.00043 ,0.01279 ,0.01081 ,0.01523 ,0.01355 ,0.02643 ,0.01750 ,-0.01492 ,-0.03527 ,-0.05219 ,-0.00101 ,0.03432 ,0.05137 ,0.03087 ,-0.00048 ,-0.01090 ,-0.02384 ,-0.03185 ,-0.00883 ,0.01698 ,0.02264 ,0.02633 ,0.01127 ,0.02948 ,0.00053 ,-0.01862 ,-0.01913 ,-0.01616 ,-0.02371 ,-0.03054 ,-0.01303 ,0.00830 ,0.02857 ,0.01331 ,0.00929 ,0.00013 ,-0.00530 ,-0.00361 ,0.02195 ,0.03250 ,0.02658 ,0.02397 ,0.01380 ,0.02156 ,-0.00426 ,-0.01779 ,-0.04440 ,-0.05034 ,-0.02017 ,0.00336 ,0.02414 ,0.02340 ,0.03869 ,0.02998 ,0.02528 ,0.00925 ,-0.01553 ,-0.06025 ,-0.04177 ,-0.02076 ,0.02446 ,0.05924 ,0.06540 ,0.05025 ,0.02442 ,-0.00406 ,-0.04105 ,-0.04990 ,-0.01645 ,0.00586 ,0.00800 ,-0.01538 ,0.01042 ,0.00679 ,0.01452 ,0.00527 ,0.00389 ,0.01365 ,0.01904 ,0.00978 ,0.01214 ,0.01897 ,0.00788 ,-0.00841 ,-0.02770 ,-0.02064 ,-0.00543 ,-0.00478 ,0.02630 ,0.06451 ,0.06157 ,0.02653 ,-0.02644 ,-0.02772 ,-0.01341 ,-0.00065 ,-0.00024 ,0.00526 ,0.00394 ,-0.00599 ,-0.01341 ,0.00375 ,0.02569 ,0.00283 ,-0.05723 ,-0.05077 ,-0.01027 ,0.02262 ,0.03426 ,0.02491 ,0.03253 ,0.02910 ,0.00471 ,0.00250 ,-0.05117 ,-0.03900 ,-0.04773 ,-0.01824 ,0.01341 ,0.03392 ,0.07246 ,0.03942 ,0.03490 ,0.01672 ,-0.00302 ,-0.03675 ,-0.05535 ,-0.02983 ,-0.04542 ,-0.03318 ,-0.00546 ,0.04461 ,0.02814 ,0.03095 ,0.02577 ,0.02654 ,0.01534 ,-0.01603 ,-0.04698 ,-0.03148 ,-0.01537 ,0.01233 ,-0.00791 ,-0.03831 ,-0.04465 ,0.00587 ,0.04815 ,0.06912 ,0.05911 ,0.02841 ,-0.00082 ,-0.02293 ,0.00756 ,0.05340 ,0.04502 ,-0.01208 ,-0.03753 ,-0.00499 ,0.00954 ,0.01439 ,0.01032 ,0.01613 ,0.00982 ,0.00558 ,0.00444 ,0.00332 ,-0.01193 ,-0.03380 ,-0.00666 ,0.01918 ,0.03322 ,-0.03138 ,-0.04786 ,-0.04802 ,-0.02027 ,-0.01773 ,0.02835 ,0.00608 ,-0.01591 ,-0.05869 ,-0.03468 ,-0.00951 ,-0.00817 ,-0.01519 ,-0.00776 ,0.00548 ,0.01465 ,0.00028 ,0.01733 ,0.03547 ,0.00599 ,0.00159 ,-0.02467 ,-0.01490 ,0.02755 ,0.03262 ,0.03282 ,-0.03259 ,-0.05592 ,-0.07264 ,-0.05736 ,-0.01008 ,0.06320 ,0.07917 ,0.01977 ,-0.00815 ,-0.01904 ,-0.01317 ,-0.01389 ,-0.01185 ,-0.02183 ,-0.00413 ,-0.00905 ,0.02334 ,-0.00053 ,-0.02386 ,-0.05436 ,-0.01538 ,0.00267 ,0.01934 ,-0.00572 ,-0.00889 ,0.02991 ,-0.02806 ,-0.03748 ,-0.08079 ,-0.06153 ,-0.08200 ,-0.07456 ,-0.05665 ,-0.04168 ,-0.00707 ,-0.00483 ,-0.01652 ,-0.00884 ,-0.01268 ,0.00408 ,0.02459 ,-0.01468 ,-0.00613 ,-0.01477 ,-0.03161 ,-0.04466 ,-0.04682 ,-0.02401 ,0.00016 ,-0.01623 ,-0.00987 ,-0.01497 ,-0.02002 ,-0.02301 ,-0.02185 ,-0.04660 ,-0.04671 ,-0.03175 ,-0.03401 ,-0.02035 ,-0.01230 ,-0.01477 ,-0.03114 ,-0.07029 ,-0.05710 ,-0.02440 ,0.00380 ,0.00880 ,-0.01198 ,0.02977 ,0.01364 ,0.02876 ,-0.01474 ,-0.05576 ,-0.10378 ,-0.08291 ,-0.04649 ,-0.04327 ,0.02135 ,-0.01886 ,0.02512 ,0.02288 ,0.07509 ,0.05673 ,0.02309 ,-0.02132 ,0.00612 ,-0.01069 ,-0.02778 ,0.01913 ,0.03003 ,-0.01798 ,-0.05147 ,-0.04729 ,-0.02013 ,0.00873 ,0.02314 ,0.02128 ,0.00552 ,0.00551 ,-0.02895 ,-0.02529 ,-0.06232 ,-0.06614 ,-0.05512 ,-0.03707 ,-0.03104 ,0.01778 ,0.03966 ,0.04648 ,-0.00743 ,-0.07679 ,-0.08757 ,-0.05867 ,-0.00979 ,-0.03375 ,-0.01770 ,-0.01224 ,0.03421 ,0.04706 ,0.07690 ,0.04543 ,0.04019 ,0.04443 ,0.03598 ,0.01174 ,0.00992 ,-0.01480 ,0.00034 ,0.02658 ,0.01549 ,0.02434 ,0.03381 ,0.00382 ,0.00519 ,-0.00227 ,-0.00841 ,-0.01848 ,0.00572 ,0.01705 ,0.05785 ,0.04201 ,0.03543 ,-0.03038 ,-0.06947 ,-0.07888 ,-0.02399 ,0.01347 ,0.02093 ,-0.02144 ,0.01581 ,0.11402 ,0.09272 ,0.05307 ,-0.00159 ,-0.02259 ,-0.03518 ,-0.00925 ,-0.02572 ,-0.03632 ,-0.04430 ,-0.07631 ,-0.04289 ,-0.02508 ,-0.00812 ,-0.01059 ,-0.01122 ,0.04147 ,0.03995 ,0.03692 ,0.04270 ,0.04089 ,0.05072 ,-0.00896 ,-0.02647 ,-0.07348 ,-0.06316 ,-0.02766 ,0.03936 ,0.10756 ,0.16998 ,0.18066 ,0.10377 ,0.00056 ,-0.00430 ,-0.02453 ,-0.05089 ,-0.01780 ,0.05532 ,0.07849 ,0.05554 ,-0.02950 ,-0.05392 ,-0.08920 ,-0.04138 ,0.02186 ,0.05197 ,0.12243 ,0.11662 ,0.10732 ,0.05464 ,0.02159 ,-0.01315 ,-0.04034 ,-0.02391 ,0.01019 ,0.04501 ,0.04810 ,0.01872 ,0.01697 ,0.06858 ,0.08053 ,0.01724 ,-0.00145 ,0.00275 ,0.02897 ,0.04525 ,0.06454 ,0.07520 ,0.10453 ,0.03874 ,0.03965 ,-0.02964 ,-0.04486 ,-0.06448 ,-0.02928 ,-0.02347 ,0.00289 ,0.01627 ,0.00912 ,-0.02244 ,-0.03162 ,-0.03699 ,0.02975 ,0.01942 ,0.01956 ,0.06341 ,0.05673 ,0.10754 ,-0.00216 ,-0.02369 ,-0.05431 ,-0.01754 ,-0.03017 ,-0.02532 ,-0.04906 ,-0.02222 ,0.10727 ,0.15557 ,0.12649 ,0.09287 ,0.03278 ,0.07184 ,0.10866 ,0.12292 ,0.08773 ,0.05392 ,0.01720 ,-0.02401 ,-0.02806 ,0.01168 ,0.02517 ,0.01529 ,-0.01356 ,-0.07133 ,-0.09449 ,-0.07932 ,-0.01757 ,0.05366 ,0.04668 ,-0.00448 ,-0.05996 ,-0.07774 ,-0.07805 ,-0.09949 ,0.00098 ,0.08458 ,0.12599 ,0.06059 ,0.01845 ,-0.00480 ,-0.05657 ,-0.11633 ,-0.16236 ,-0.11600 ,-0.04180 ,0.04274 ,0.07611 ,0.07544 ,0.06583 ,0.00581 ,-0.09601 ,-0.09232 ,0.00110 ,0.07686 ,0.09804 ,0.05340 ,0.00274 ,-0.05182 ,-0.06305 ,-0.04731 ,-0.01819 ,0.01366 ,-0.00270 ,0.00313 ,-0.03554 ,-0.11414 ,-0.16946 ,-0.22125 ,-0.20091 ,-0.11941 ,-0.01523 ,0.07892 ,0.11334 ,0.04624 ,-0.01956 ,-0.01733 ,0.05080 ,0.03123 ,-0.05927 ,-0.18934 ,-0.17607 ,-0.07193 ,0.08677 ,0.15488 ,0.15803 ,0.08837 ,0.08431 ,0.01347 ,-0.03577 ,-0.05614 ,-0.04195 ,-0.01862 ,-0.00235 ,-0.03673 ,-0.03609 ,-0.02364 ,0.01120 ,0.01767 ,0.00226 ,-0.01815 ,0.03053 ,0.04896 ,0.12033 ,0.14765 ,0.09961 ,-0.00949 ,-0.11024 ,-0.14985 ,-0.10270 ,-0.06489 ,-0.02295 ,0.04068 ,0.05715 ,0.07140 ,0.02239 ,-0.05151 ,-0.10568 ,-0.12218 ,-0.13294 ,-0.10852 ,-0.07961 ,-0.09132 ,-0.06591 ,-0.00883 ,0.02575 ,0.09134 ,0.10408 ,0.10951 ,0.05880 ,0.03550 ,-0.03858 ,-0.12289 ,-0.11203 ,0.00624 ,0.17924 ,0.40902 ,0.58226 ,0.23792 ,-0.35556 ,-0.95000 };
    /* Generated with AutoIR_load_txt2.m matlab code */
    float P2[1024]={0.00323,0.00164 ,0.00288 ,0.00095 ,0.00093 ,0.00111 ,0.00544 ,0.00338 ,-0.00051 ,-0.00452 ,-0.00100 ,0.00118 ,-0.00009 ,-0.00433 ,-0.00270 ,0.00220 ,0.00407 ,0.00692 ,0.00790 ,-0.00033 ,-0.00195 ,-0.00504 ,-0.00000 ,0.00362 ,0.00334 ,0.00140 ,0.00101 ,0.00436 ,0.00292 ,-0.00094 ,0.00152 ,-0.00124 ,-0.00139 ,-0.00244 ,-0.00231 ,-0.00134 ,-0.00141 ,0.00090 ,0.00054 ,-0.00172 ,0.00150 ,-0.00419 ,-0.00361 ,-0.00174 ,-0.00058 ,-0.00135 ,-0.00371 ,-0.00572 ,-0.00466 ,-0.00394 ,0.00032 ,0.00424 ,-0.00100 ,-0.00024 ,0.00007 ,0.00315 ,0.00488 ,0.00627 ,0.00487 ,0.00207 ,0.00108 ,-0.00410 ,-0.00287 ,-0.00111 ,-0.00167 ,-0.00156 ,-0.00531 ,-0.00421 ,-0.00137 ,0.00062 ,0.00193 ,0.00118 ,-0.00105 ,-0.00286 ,0.00103 ,0.00158 ,0.00113 ,0.00167 ,0.00068 ,0.00412 ,-0.00249 ,-0.00185 ,-0.00646 ,-0.00521 ,-0.00039 ,0.00729 ,0.00898 ,0.00334 ,0.00153 ,-0.00115 ,-0.00418 ,-0.00505 ,-0.00142 ,0.00308 ,0.00177 ,0.00004 ,0.00657 ,0.00900 ,0.00029 ,-0.00090 ,-0.00144 ,-0.00303 ,0.00336 ,0.00700 ,0.01185 ,0.00350 ,0.00207 ,-0.00683 ,-0.00672 ,-0.00185 ,-0.00449 ,-0.00318 ,-0.00827 ,-0.00563 ,0.00190 ,-0.00308 ,-0.00222 ,0.00168 ,0.00804 ,0.00830 ,0.00462 ,0.00306 ,-0.00126 ,-0.00108 ,-0.00234 ,-0.00045 ,-0.00121 ,0.00039 ,0.00133 ,-0.00169 ,0.00023 ,0.00310 ,0.00440 ,-0.00062 ,-0.00533 ,-0.00755 ,-0.00066 ,0.00713 ,0.00393 ,0.00372 ,-0.00009 ,-0.00633 ,-0.00794 ,-0.00749 ,-0.00502 ,0.00221 ,0.00420 ,-0.00111 ,-0.00358 ,-0.00244 ,-0.00137 ,-0.00439 ,-0.00435 ,0.00314 ,0.00351 ,-0.00263 ,-0.00845 ,-0.00529 ,0.00335 ,0.00900 ,0.00811 ,0.00661 ,0.00461 ,0.00016 ,-0.00685 ,-0.00285 ,0.00892 ,0.00954 ,0.00229 ,-0.00302 ,-0.00606 ,0.00204 ,-0.00310 ,-0.00161 ,-0.00237 ,-0.00579 ,0.00064 ,0.00436 ,0.00860 ,0.00773 ,0.00969 ,0.00639 ,-0.00431 ,-0.00589 ,-0.00314 ,-0.00497 ,-0.00159 ,-0.00041 ,0.00227 ,0.00360 ,-0.00223 ,-0.00679 ,-0.00843 ,-0.00193 ,0.00310 ,0.00478 ,0.00814 ,0.00528 ,0.00088 ,0.00440 ,0.00558 ,0.00257 ,0.00177 ,0.00022 ,-0.00188 ,-0.00436 ,-0.00168 ,0.00324 ,0.00199 ,-0.00391 ,-0.00438 ,-0.00026 ,0.00534 ,0.00514 ,0.00199 ,0.00075 ,0.00054 ,-0.00347 ,-0.00959 ,-0.00294 ,0.00015 ,0.00192 ,0.00127 ,-0.00257 ,-0.00466 ,-0.00895 ,-0.00547 ,0.00021 ,0.00330 ,0.00965 ,0.01030 ,0.00623 ,0.00114 ,-0.00809 ,-0.00741 ,-0.01352 ,-0.00522 ,-0.00396 ,-0.00185 ,0.00458 ,0.00447 ,0.00293 ,-0.01142 ,-0.01250 ,-0.00423 ,0.00107 ,0.01002 ,0.00804 ,0.00699 ,0.00222 ,-0.00402 ,0.00112 ,0.00181 ,0.00305 ,0.00701 ,0.00189 ,0.00175 ,-0.00461 ,-0.00560 ,-0.00808 ,-0.00752 ,-0.00016 ,-0.00111 ,-0.00103 ,0.00183 ,0.00220 ,-0.00079 ,-0.00674 ,-0.00073 ,0.01046 ,0.00848 ,0.00371 ,-0.00059 ,0.00477 ,0.00548 ,0.00330 ,0.00126 ,-0.00033 ,0.00395 ,0.00617 ,0.00384 ,-0.00065 ,0.00225 ,0.00230 ,-0.00790 ,-0.00838 ,0.00139 ,0.00724 ,-0.00029 ,0.00213 ,-0.00044 ,-0.00286 ,-0.00704 ,-0.00200 ,-0.00157 ,-0.00187 ,0.00131 ,0.00151 ,-0.00556 ,-0.00135 ,-0.00434 ,-0.00463 ,-0.01182 ,-0.00554 ,-0.00530 ,-0.00429 ,-0.00258 ,0.00049 ,-0.00065 ,0.00259 ,0.00703 ,0.00331 ,-0.00260 ,0.00051 ,0.00058 ,-0.00072 ,-0.00172 ,-0.00016 ,0.00149 ,-0.00044 ,0.00380 ,-0.00040 ,0.00361 ,-0.00282 ,-0.00729 ,-0.01156 ,-0.00190 ,0.00075 ,0.00626 ,0.00093 ,0.00243 ,-0.00257 ,0.00088 ,0.00519 ,0.00832 ,0.00314 ,-0.00337 ,-0.00400 ,-0.00801 ,-0.00320 ,-0.00233 ,0.00404 ,0.00258 ,0.00455 ,0.00090 ,-0.00516 ,-0.00847 ,0.00150 ,0.01078 ,0.01735 ,0.01145 ,0.00357 ,-0.00633 ,-0.01243 ,-0.00241 ,-0.00215 ,0.00472 ,0.01111 ,0.00766 ,0.00601 ,0.00622 ,0.00848 ,0.00321 ,-0.00041 ,-0.00753 ,-0.00406 ,-0.00607 ,-0.01269 ,-0.01195 ,-0.01229 ,-0.00695 ,-0.00026 ,0.00541 ,0.01203 ,0.00349 ,0.00526 ,0.00397 ,0.00955 ,0.00911 ,0.00165 ,-0.00170 ,-0.00474 ,-0.00655 ,-0.00107 ,-0.00412 ,-0.00983 ,-0.01139 ,-0.00445 ,0.00835 ,0.01297 ,0.01378 ,0.01084 ,0.00290 ,-0.00611 ,-0.01065 ,-0.00494 ,0.00036 ,-0.00123 ,0.00515 ,-0.00106 ,0.00147 ,-0.00277 ,0.00494 ,0.00401 ,0.00260 ,-0.00135 ,-0.00457 ,-0.00120 ,-0.00007 ,0.00104 ,0.00599 ,0.00187 ,0.00012 ,0.00047 ,-0.00023 ,-0.00176 ,-0.00100 ,-0.00123 ,-0.00577 ,-0.00173 ,0.00250 ,0.00678 ,0.00208 ,0.00384 ,0.00563 ,0.00428 ,-0.00098 ,-0.00367 ,-0.00130 ,-0.00141 ,0.00089 ,0.00193 ,0.00576 ,-0.00053 ,0.00118 ,-0.00091 ,0.00143 ,-0.00310 ,-0.00575 ,-0.01202 ,-0.00656 ,-0.00605 ,-0.00510 ,-0.00207 ,-0.00063 ,0.00545 ,0.00101 ,0.01249 ,0.00679 ,0.00954 ,0.00713 ,0.01205 ,0.01624 ,0.00425 ,0.00354 ,0.00554 ,-0.00204 ,-0.00492 ,-0.01538 ,-0.01164 ,-0.00773 ,-0.01444 ,-0.01021 ,0.00157 ,0.00535 ,0.00101 ,-0.00772 ,-0.00481 ,-0.00008 ,0.00629 ,0.01597 ,0.01218 ,0.00978 ,0.00285 ,-0.00190 ,-0.00714 ,-0.00625 ,-0.00405 ,-0.00956 ,-0.01819 ,-0.01395 ,-0.01616 ,-0.00660 ,-0.00105 ,0.01408 ,0.01187 ,0.01168 ,0.00239 ,-0.00764 ,-0.01228 ,-0.00899 ,-0.00384 ,-0.00009 ,-0.00371 ,-0.00643 ,-0.00484 ,-0.00863 ,-0.00718 ,0.00181 ,0.00594 ,0.01118 ,0.01115 ,0.01291 ,0.00835 ,-0.00206 ,-0.00667 ,-0.00322 ,-0.01159 ,-0.01633 ,-0.00462 ,0.00098 ,0.00613 ,0.00436 ,-0.00149 ,0.00240 ,-0.00192 ,0.00013 ,0.00218 ,0.01001 ,0.00614 ,0.00607 ,-0.00301 ,-0.01475 ,-0.01005 ,-0.00880 ,-0.01543 ,0.00540 ,0.00113 ,0.00320 ,-0.00510 ,-0.00421 ,0.00524 ,-0.00074 ,0.00724 ,0.01104 ,0.00514 ,-0.01048 ,-0.01407 ,-0.01140 ,-0.00362 ,0.00239 ,-0.00306 ,0.00342 ,-0.00982 ,0.00296 ,-0.00134 ,-0.00438 ,-0.01339 ,-0.01360 ,-0.00845 ,-0.00787 ,0.00844 ,-0.00133 ,0.00899 ,0.00994 ,0.00497 ,0.00041 ,-0.01076 ,-0.00586 ,0.00076 ,-0.00665 ,0.00536 ,0.00877 ,0.00355 ,-0.00734 ,-0.00998 ,-0.01312 ,0.00150 ,-0.00090 ,0.00017 ,-0.00409 ,-0.00062 ,0.00610 ,0.00862 ,0.00410 ,-0.00780 ,-0.01552 ,-0.01642 ,-0.00287 ,-0.00067 ,0.00905 ,0.00307 ,0.00204 ,0.00654 ,0.00932 ,0.00602 ,0.00440 ,-0.00930 ,-0.01498 ,-0.00929 ,-0.01660 ,-0.00727 ,0.00678 ,0.01841 ,0.02227 ,0.01582 ,0.01912 ,0.01707 ,-0.00045 ,-0.00653 ,-0.01341 ,-0.01038 ,-0.00740 ,0.00356 ,0.00269 ,0.00171 ,0.00566 ,0.00671 ,0.00062 ,-0.00855 ,-0.00319 ,0.00342 ,0.00964 ,0.01351 ,0.00531 ,0.00045 ,-0.00607 ,-0.00636 ,0.00779 ,0.01352 ,0.01785 ,0.02018 ,0.00354 ,-0.00410 ,-0.01340 ,-0.00481 ,-0.00433 ,-0.00311 ,0.01062 ,0.00980 ,0.02032 ,0.00174 ,0.00909 ,0.00890 ,0.01070 ,0.01317 ,0.00941 ,0.00750 ,-0.00724 ,-0.00816 ,-0.01766 ,-0.01971 ,-0.00429 ,0.00962 ,0.01743 ,0.01866 ,0.02078 ,0.00885 ,-0.00417 ,-0.00689 ,-0.00654 ,-0.00022 ,0.01259 ,0.00967 ,0.00275 ,-0.00551 ,0.00165 ,-0.00164 ,-0.00347 ,0.02027 ,0.01987 ,0.01582 ,0.00063 ,-0.01459 ,-0.01948 ,-0.00947 ,0.00087 ,0.00496 ,-0.00414 ,-0.00810 ,-0.00660 ,-0.00053 ,-0.00471 ,-0.00106 ,0.01991 ,0.01859 ,0.01109 ,0.00552 ,-0.00474 ,-0.00677 ,-0.01563 ,0.01138 ,-0.01323 ,-0.00682 ,-0.01564 ,-0.01191 ,-0.00382 ,0.02085 ,0.02712 ,0.00794 ,-0.00230 ,-0.00284 ,-0.00911 ,0.00784 ,0.02510 ,0.02878 ,0.00300 ,0.00204 ,-0.00120 ,-0.01551 ,-0.00594 ,0.00042 ,0.00333 ,0.00613 ,0.01494 ,0.01135 ,0.00305 ,-0.00973 ,-0.00268 ,-0.00237 ,-0.00029 ,0.00106 ,-0.00620 ,-0.00070 ,0.00728 ,0.01417 ,0.01521 ,0.00274 ,-0.00138 ,-0.01672 ,-0.01966 ,-0.01530 ,-0.00145 ,0.00546 ,0.00044 ,0.00167 ,-0.00929 ,0.00378 ,-0.00360 ,0.00201 ,-0.01173 ,-0.02392 ,-0.01941 ,-0.00550 ,0.00166 ,0.00056 ,0.02191 ,0.01286 ,0.01485 ,0.02000 ,0.01716 ,0.01604 ,-0.00276 ,-0.01404 ,-0.01229 ,-0.00221 ,0.00946 ,0.01183 ,-0.00718 ,-0.01810 ,-0.02353 ,-0.03540 ,-0.04148 ,-0.04225 ,-0.03035 ,-0.00588 ,0.01871 ,0.01975 ,0.02665 ,0.01159 ,0.00587 ,-0.00626 ,0.00464 ,0.01264 ,0.00114 ,-0.00502 ,-0.01995 ,-0.02557 ,-0.03467 ,-0.01491 ,0.00108 ,-0.02064 ,-0.02021 ,-0.00564 ,0.01384 ,-0.00044 ,-0.00647 ,-0.00878 ,-0.00571 ,0.00087 ,-0.00752 ,-0.02544 ,-0.03756 ,-0.03524 ,-0.03341 ,-0.01239 ,0.00035 ,0.01481 ,0.01620 ,0.00878 ,0.00812 ,-0.00882 ,-0.02217 ,-0.01561 ,-0.00930 ,-0.00438 ,-0.00313 ,0.00748 ,-0.00993 ,-0.02460 ,-0.02282 ,-0.01388 ,-0.00780 ,0.01972 ,0.02077 ,0.01025 ,-0.00315 ,-0.00185 ,0.00653 ,-0.00301 ,-0.01671 ,-0.03349 ,-0.03764 ,-0.01823 ,-0.01297 ,-0.00159 ,-0.00792 ,-0.00432 ,0.00403 ,0.00445 ,-0.00297 ,0.00567 ,0.02065 ,0.03675 ,0.03599 ,0.04716 ,0.04570 ,0.01110 ,0.00716 ,-0.01612 ,-0.01549 ,-0.03203 ,-0.02032 ,-0.02484 ,-0.03864 ,0.00640 ,0.01125 ,0.01540 ,0.00896 ,0.00947 ,-0.01378 ,-0.00868 ,0.00556 ,0.00091 ,0.00479 ,0.00098 ,-0.03319 ,-0.00286 ,0.00605 ,-0.00407 ,-0.00912 ,-0.02759 ,-0.03062 ,-0.01364 ,-0.01247 ,-0.00645 ,-0.00617 ,0.01184 ,0.01675 ,0.01512 ,0.01270 ,0.00389 ,-0.00481 ,-0.02053 ,0.03073 ,0.03904 ,0.05493 ,0.04019 ,0.04436 ,0.03625 ,0.03470 ,0.04089 ,0.02669 ,0.01458 ,0.00252 ,-0.01212 ,-0.00515 ,0.00872 ,0.00809 ,-0.01999 ,-0.00188 ,0.01450 ,0.03523 ,0.04356 ,0.02926 ,0.01778 ,-0.00092 ,0.00627 ,-0.00129 ,0.00621 ,0.00777 ,0.01136 ,0.00190 ,0.00263 ,-0.00258 ,-0.01311 ,-0.01127 ,-0.01049 ,0.01999 ,0.03296 ,0.02542 ,0.01118 ,-0.02595 ,-0.03721 ,-0.02844 ,-0.00908 ,0.01857 ,0.04908 ,0.05138 ,0.04723 ,0.05401 ,0.03767 ,0.03113 ,0.02054 ,-0.00345 ,-0.01436 ,0.00815 ,0.03096 ,0.03990 ,0.03455 ,0.01571 ,0.00999 ,0.02131 ,0.00611 ,-0.02623 ,-0.05507 ,-0.06452 ,-0.04741 ,-0.02361 ,0.00123 ,0.03182 ,0.05237 ,0.05767 ,0.03361 ,0.01653 ,-0.01227 ,-0.02994 ,-0.03980 ,-0.03163 ,-0.01462 ,0.00291 ,-0.00083 ,-0.01483 ,0.00343 ,-0.00981 ,0.00127 ,0.01202 ,0.00995 ,0.02118 ,0.01922 ,0.01803 ,0.01315 ,0.01157 ,-0.00542 ,-0.02363 ,-0.01808 ,-0.00557 ,0.00914 ,0.02412 ,0.04083 ,0.02500 ,0.03471 ,0.01191 ,0.01808 ,-0.00456 ,-0.01023 ,0.00154 ,-0.00176 ,0.00270 ,-0.00850 ,-0.01390 ,-0.00483 ,-0.01077 ,-0.01746 ,-0.05105 ,-0.02647 ,-0.02184 ,-0.01160 ,-0.00712 ,0.00869 ,0.01242 ,-0.03568 ,-0.05687 ,-0.07274 ,-0.05758 ,-0.01074 ,0.00534 ,-0.00057 ,0.01731 ,0.00453 ,-0.00506 ,0.00774 ,0.00032 ,-0.03232 ,-0.03505 ,0.00058 ,0.03281 ,0.06295 ,0.05082 ,0.04443 ,0.05458 ,0.06031 ,0.06576 ,0.05204 ,0.03941 ,0.01198 ,-0.00883 ,-0.00281 ,-0.00640 ,0.00046 ,0.01871 ,0.02059 ,0.01564 ,-0.03130 ,-0.04440 ,-0.05106 ,-0.03970 ,-0.03228 ,-0.04137 ,0.00472 ,0.03008 ,0.00584 ,-0.10930 ,0.91692 };
	//Reference to local copy of settings stored in flash
	Settings &LocalSettings = SavedSettings.GetSettings();

	memcpy(&LocalSettings.p1,&P1, 2048 * sizeof(float));
    memcpy(&LocalSettings.p2,&P2, 1024 * sizeof(float));
	//LocalSettings.p2 = value;
    // for(size_t i = 0; i < 2048; i += 1)
    // {
    //     LocalSettings.p1[i] = P1[i];
    // }
	trigger_save = true;
}

void ProcessControls() {

    FSW1.Debounce(); // Debounce FSW1
    if (FSW1.RisingEdge())
    {
        Save();        
        led2.Toggle(); // Toggle the LED2

    }

    FSW2.Debounce(); // Debounce FSW1
    if (FSW2.RisingEdge())
    {
        Load();
        if (state1[2047] ==-0.95000)
        {
            led1.Write(true);
        }
        else
        {
            led1.Write(false);
        }
        led2.Toggle(); // Toggle the LED2
    }
}


void AudioCallback(AudioHandle::InputBuffer in, AudioHandle::OutputBuffer out, size_t size)
{
	
	ProcessControls();

	for (size_t i = 0; i < size; i++)
	{
    	out[0][i] = in[0][i];
    	out[1][i] = in[1][i];
	}
}

int main(void)
{
    hw.Configure();
	hw.Init();
	hw.SetAudioBlockSize(4); // number of samples handled per callback
	hw.SetAudioSampleRate(SaiHandle::Config::SampleRate::SAI_48KHZ);
    // state1=0.0f;
    // state2=0.0f;
/******************************************************/
    // Led 1 and footwitch 1
    // Initialize led1 to pin D22 as an OUTPUT
    led1.Init(daisy::seed::D22, daisy::GPIO::Mode::OUTPUT);
    led2.Init(daisy::seed::D23, daisy::GPIO::Mode::OUTPUT);
    /******************************************************/
    //Set button to pin D26, to be updated at a 1kHz  samplerate
    FSW1.Init(daisy::seed::D26, 1000,daisy::Switch::TYPE_MOMENTARY,daisy::Switch::POLARITY_INVERTED,daisy::Switch::PULL_UP); 
    FSW2.Init(daisy::seed::D25, 1000,daisy::Switch::TYPE_MOMENTARY,daisy::Switch::POLARITY_INVERTED,daisy::Switch::PULL_UP);

    //passThruOn = true;// This starts the pedal in the 'off' 
    // Set the pin LOW
    led1.Write(false);
    led2.Write(false);

    /*****************************************************/
	
	//Initilize the PersistentStorage Object with default values.
	//Defaults will be the first values stored in flash when the device is first turned on. They can also be restored at a later date using the RestoreDefaults method
	Settings DefaultSettings = {0.0f, 0.0f};
	SavedSettings.Init(DefaultSettings);

    hw.StartLog(false);
	//hw.StartAdc();
	hw.StartAudio(AudioCallback);
    //Save();
    Load();
	while(1) {
		if(trigger_save) {
			
			SavedSettings.Save(); // Writing locally stored settings to the external flash
			trigger_save = false;
		}
		System::Delay(100);
	}
}